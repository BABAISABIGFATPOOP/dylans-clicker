<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pollution Clicker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #2d1f3d 100%);
            min-height: 100vh;
            color: #fff;
            overflow-x: hidden;
        }

        .game-container {
            display: flex;
            min-height: 100vh;
        }

        .main-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .news-ticker {
            width: 100%;
            background: rgba(0, 0, 0, 0.8);
            border-bottom: 2px solid #333;
            padding: 12px 20px;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .news-label {
            background: #ff4444;
            color: #fff;
            padding: 4px 10px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.8rem;
            white-space: nowrap;
        }

        .news-text {
            color: #ccc;
            font-size: 0.95rem;
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .news-text span {
            color: #ffd700;
        }

        .game-container {
            padding-top: 50px;
        }

        .planet-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .planet-tab {
            padding: 8px 16px;
            border: 2px solid #444;
            border-radius: 20px;
            background: rgba(0,0,0,0.4);
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .planet-tab:hover:not(.locked) {
            border-color: #888;
        }

        .planet-tab.active {
            border-color: #ffd700;
            background: rgba(255, 215, 0, 0.2);
        }

        .planet-tab.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .planet-tab .planet-emoji {
            margin-right: 5px;
        }

        .score-display {
            text-align: center;
            margin-bottom: 30px;
        }

        .planet-name {
            font-size: 1.2rem;
            color: #888;
            margin-bottom: 5px;
        }

        .score {
            font-size: 2.5rem;
            font-weight: bold;
            color: #7cfc00;
            text-shadow: 0 0 20px rgba(124, 252, 0, 0.5);
        }

        .score.polluted {
            color: #ff4444;
            text-shadow: 0 0 20px rgba(255, 68, 68, 0.5);
        }

        .per-second {
            font-size: 1.2rem;
            color: #aaa;
            margin-top: 10px;
        }

        .multiplier {
            font-size: 1rem;
            color: #ffd700;
            margin-top: 5px;
        }

        .globe-container {
            position: relative;
            width: 280px;
            height: 280px;
        }

        .globe-btn {
            width: 250px;
            height: 250px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            position: relative;
            box-shadow:
                0 0 60px rgba(30, 87, 153, 0.4),
                inset -20px -20px 40px rgba(0, 0, 0, 0.4),
                inset 10px 10px 40px rgba(255, 255, 255, 0.1);
            transition: transform 0.1s, filter 0.3s, background 0.5s;
            overflow: hidden;
        }

        .globe-btn:hover {
            transform: scale(1.05);
        }

        .globe-btn:active {
            transform: scale(0.95);
        }

        .smog-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(139, 90, 43, 0) 0%, rgba(139, 90, 43, 0) 100%);
            pointer-events: none;
            transition: background 0.5s;
        }

        .pollution-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .shop-panel {
            width: 380px;
            background: rgba(0, 0, 0, 0.5);
            padding: 20px;
            overflow-y: auto;
            border-left: 2px solid #333;
        }

        .shop-title {
            font-size: 1.5rem;
            text-align: center;
            margin-bottom: 20px;
            color: #ff6b6b;
            border-bottom: 2px solid #ff6b6b;
            padding-bottom: 10px;
        }

        .section-title {
            font-size: 1.1rem;
            color: #ffd700;
            margin: 20px 0 10px 0;
            padding-bottom: 5px;
            border-bottom: 1px solid #ffd700;
        }

        .upgrade-item, .planet-item {
            background: linear-gradient(135deg, #2a2a3a 0%, #1a1a2a 100%);
            border: 2px solid #444;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .upgrade-item:hover:not(.disabled), .planet-item:hover:not(.disabled):not(.owned) {
            border-color: #ff6b6b;
        }

        .upgrade-item.disabled, .planet-item.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .planet-item.owned {
            border-color: #4ade80;
            opacity: 0.7;
        }

        .upgrade-header, .planet-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .upgrade-name, .planet-unlock-name {
            font-size: 1.1rem;
            font-weight: bold;
        }

        .upgrade-icon, .planet-unlock-icon {
            font-size: 1.3rem;
            margin-right: 8px;
        }

        .upgrade-count {
            background: #ff6b6b;
            color: #000;
            padding: 2px 10px;
            border-radius: 15px;
            font-weight: bold;
        }

        .upgrade-desc, .planet-desc {
            font-size: 0.85rem;
            color: #aaa;
            margin-bottom: 8px;
        }

        .upgrade-cost, .planet-cost {
            color: #ff6b6b;
            font-weight: bold;
        }

        .planet-item.owned .planet-cost {
            color: #4ade80;
        }

        .click-particle {
            position: fixed;
            pointer-events: none;
            font-size: 1.5rem;
            font-weight: bold;
            color: #888;
            text-shadow: 0 0 10px rgba(100, 100, 100, 0.8);
            animation: float-up 1s ease-out forwards;
            z-index: 1000;
        }

        @keyframes float-up {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) scale(1.5);
            }
        }

        .smoke-particle {
            position: absolute;
            width: 8px;
            height: 8px;
            background: rgba(100, 100, 100, 0.6);
            border-radius: 50%;
            animation: smoke-rise 2s ease-out forwards;
        }

        @keyframes smoke-rise {
            0% {
                opacity: 0.8;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-150px) scale(3);
            }
        }

        .stats {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px 20px;
            border-radius: 10px;
            font-size: 0.9rem;
            border: 1px solid #333;
        }

        .stats div {
            margin: 5px 0;
        }

        .pollution-bar {
            width: 100%;
            height: 20px;
            background: #1a1a1a;
            border-radius: 10px;
            margin-top: 15px;
            overflow: hidden;
            border: 1px solid #333;
        }

        .pollution-fill {
            height: 100%;
            background: linear-gradient(90deg, #4ade80, #fbbf24, #f87171, #7c3aed);
            transition: width 0.3s;
            border-radius: 10px;
        }

        .pollution-label {
            text-align: center;
            margin-top: 8px;
            font-size: 0.9rem;
            color: #aaa;
        }

        @media (max-width: 768px) {
            .game-container {
                flex-direction: column;
            }
            .shop-panel {
                width: 100%;
                border-left: none;
                border-top: 2px solid #333;
            }
            .globe-btn {
                width: 180px;
                height: 180px;
            }
            .globe-container {
                width: 200px;
                height: 200px;
            }
            .stats {
                position: static;
                margin: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="news-ticker">
        <div class="news-label">NEWS</div>
        <div class="news-text" id="news-text">Welcome to Earth. The air is still breathable... for now.</div>
    </div>
    <div class="game-container">
        <div class="main-area">
            <div class="planet-selector" id="planet-tabs"></div>
            <div class="score-display">
                <div class="planet-name" id="planet-name">Earth</div>
                <div class="score" id="score-text"><span id="pollution">0</span> tons of CO2</div>
                <div class="per-second">polluting at: <span id="pps">0</span>/sec</div>
                <div class="multiplier" id="multiplier-display">Multiplier: x1</div>
            </div>
            <div class="globe-container">
                <button class="globe-btn" id="globe" title="Pollute!"></button>
                <div class="smog-layer" id="smog"></div>
                <div class="pollution-particles" id="particles"></div>
            </div>
            <div class="pollution-bar">
                <div class="pollution-fill" id="pollution-fill" style="width: 0%"></div>
            </div>
            <div class="pollution-label"><span id="current-planet-name">Earth</span> Pollution: <span id="pollution-percent">0</span>%</div>
        </div>
        <div class="shop-panel">
            <h2 class="shop-title">Pollution Sources</h2>
            <div id="upgrades"></div>
            <div class="section-title">Unlock Planets</div>
            <div id="planet-shop"></div>
        </div>
    </div>
    <div class="stats">
        <div>Pollution Power: <span id="click-power">1</span> tons/click</div>
        <div>Total Clicks: <span id="total-clicks">0</span></div>
        <div>Total Pollution: <span id="total-pollution">0</span> tons</div>
        <div>Planets Destroyed: <span id="planets-destroyed">0</span></div>
    </div>

    <script>
        // Planets
        const planets = [
            {
                id: 'earth',
                name: 'Earth',
                icon: 'ðŸŒ',
                unlocked: true,
                cost: 0,
                multiplier: 1,
                maxPollution: 1000000000000,
                pollution: 0,
                colors: {
                    clean: 'radial-gradient(circle at 30% 30%, #4a90d9, #1e5799 40%, #0d3a6e 70%, #082040)',
                    mid: 'radial-gradient(circle at 30% 30%, #5a9aca, #2a6a99 40%, #1a4a70 70%, #0a2a40)',
                    dirty: 'radial-gradient(circle at 30% 30%, #6a8b9a, #3d5c6e 40%, #2a4050 70%, #152030)',
                    dead: 'radial-gradient(circle at 30% 30%, #8b7355, #5c4a3a 40%, #3d3028 70%, #1a1510)'
                }
            },
            {
                id: 'mercury',
                name: 'Mercury',
                icon: 'ðŸª¨',
                unlocked: false,
                cost: 5000000,
                multiplier: 1.5,
                maxPollution: 2000000000000,
                pollution: 0,
                colors: {
                    clean: 'radial-gradient(circle at 30% 30%, #9a9a9a, #7a7a7a 40%, #5a5a5a 70%, #3a3a3a)',
                    mid: 'radial-gradient(circle at 30% 30%, #8a8a8a, #6a6a6a 40%, #4a4a4a 70%, #2a2a2a)',
                    dirty: 'radial-gradient(circle at 30% 30%, #7a7a7a, #5a5a5a 40%, #3a3a3a 70%, #1a1a1a)',
                    dead: 'radial-gradient(circle at 30% 30%, #4a4a4a, #3a3a3a 40%, #2a2a2a 70%, #1a1a1a)'
                }
            },
            {
                id: 'venus',
                name: 'Venus',
                icon: 'ðŸŸ¡',
                unlocked: false,
                cost: 15000000,
                multiplier: 3,
                maxPollution: 8000000000000,
                pollution: 0,
                colors: {
                    clean: 'radial-gradient(circle at 30% 30%, #e6b800, #cc9900 40%, #997300 70%, #4d3a00)',
                    mid: 'radial-gradient(circle at 30% 30%, #cca300, #b38600 40%, #806000 70%, #403000)',
                    dirty: 'radial-gradient(circle at 30% 30%, #b38f00, #997a00 40%, #665200 70%, #332900)',
                    dead: 'radial-gradient(circle at 30% 30%, #6b5a28, #5a4a20 40%, #4a3a18 70%, #2a2010)'
                }
            },
            {
                id: 'mars',
                name: 'Mars',
                icon: 'ðŸ”´',
                unlocked: false,
                cost: 50000000,
                multiplier: 5,
                maxPollution: 15000000000000,
                pollution: 0,
                colors: {
                    clean: 'radial-gradient(circle at 30% 30%, #c1440e, #8b3103 40%, #5c2102 70%, #2d1001)',
                    mid: 'radial-gradient(circle at 30% 30%, #a33d0d, #7a2e0a 40%, #4d1d06 70%, #261003)',
                    dirty: 'radial-gradient(circle at 30% 30%, #85360c, #632808 40%, #3e1905 70%, #1f0c02)',
                    dead: 'radial-gradient(circle at 30% 30%, #4a3728, #3a2a1e 40%, #2a1e14 70%, #1a100a)'
                }
            },
            {
                id: 'ceres',
                name: 'Ceres',
                icon: 'ðŸŒ‘',
                unlocked: false,
                cost: 200000000,
                multiplier: 8,
                maxPollution: 30000000000000,
                pollution: 0,
                colors: {
                    clean: 'radial-gradient(circle at 30% 30%, #8c8c8c, #6e6e6e 40%, #505050 70%, #323232)',
                    mid: 'radial-gradient(circle at 30% 30%, #7c7c7c, #5e5e5e 40%, #404040 70%, #222222)',
                    dirty: 'radial-gradient(circle at 30% 30%, #6c6c6c, #4e4e4e 40%, #303030 70%, #121212)',
                    dead: 'radial-gradient(circle at 30% 30%, #3c3c3c, #2e2e2e 40%, #202020 70%, #101010)'
                }
            },
            {
                id: 'jupiter',
                name: 'Jupiter',
                icon: 'ðŸŸ ',
                unlocked: false,
                cost: 1000000000,
                multiplier: 15,
                maxPollution: 100000000000000,
                pollution: 0,
                colors: {
                    clean: 'radial-gradient(circle at 30% 30%, #d4a574, #c98b4a 40%, #a86e30 70%, #5c3d1a)',
                    mid: 'radial-gradient(circle at 30% 30%, #c49464, #b87a3a 40%, #985e20 70%, #4c2f10)',
                    dirty: 'radial-gradient(circle at 30% 30%, #b48354, #a86a2a 40%, #884e10 70%, #3c2100)',
                    dead: 'radial-gradient(circle at 30% 30%, #5a4a38, #4a3a28 40%, #3a2a18 70%, #2a1a08)'
                }
            },
            {
                id: 'saturn',
                name: 'Saturn',
                icon: 'ðŸª',
                unlocked: false,
                cost: 10000000000,
                multiplier: 25,
                maxPollution: 500000000000000,
                pollution: 0,
                colors: {
                    clean: 'radial-gradient(circle at 30% 30%, #e8d5a3, #d4bc7a 40%, #b89a50 70%, #6b5a30)',
                    mid: 'radial-gradient(circle at 30% 30%, #d8c593, #c4ac6a 40%, #a88a40 70%, #5b4a20)',
                    dirty: 'radial-gradient(circle at 30% 30%, #c8b583, #b49c5a 40%, #987a30 70%, #4b3a10)',
                    dead: 'radial-gradient(circle at 30% 30%, #6a5a40, #5a4a30 40%, #4a3a20 70%, #2a2010)'
                }
            },
            {
                id: 'neptune',
                name: 'Neptune',
                icon: 'ðŸ”µ',
                unlocked: false,
                cost: 100000000000,
                multiplier: 50,
                maxPollution: 2000000000000000,
                pollution: 0,
                colors: {
                    clean: 'radial-gradient(circle at 30% 30%, #4169e1, #3158c4 40%, #2147a7 70%, #112a6b)',
                    mid: 'radial-gradient(circle at 30% 30%, #3159d1, #2148b4 40%, #113797 70%, #011a5b)',
                    dirty: 'radial-gradient(circle at 30% 30%, #2149c1, #1138a4 40%, #012787 70%, #010a4b)',
                    dead: 'radial-gradient(circle at 30% 30%, #3a3a5a, #2a2a4a 40%, #1a1a3a 70%, #0a0a2a)'
                }
            },
            {
                id: 'pluto',
                name: 'Pluto',
                icon: 'âš«',
                unlocked: false,
                cost: 500000000000,
                multiplier: 75,
                maxPollution: 5000000000000000,
                pollution: 0,
                colors: {
                    clean: 'radial-gradient(circle at 30% 30%, #a89f96, #8a827a 40%, #6c655e 70%, #3e3a36)',
                    mid: 'radial-gradient(circle at 30% 30%, #988f86, #7a726a 40%, #5c554e 70%, #2e2a26)',
                    dirty: 'radial-gradient(circle at 30% 30%, #887f76, #6a625a 40%, #4c453e 70%, #1e1a16)',
                    dead: 'radial-gradient(circle at 30% 30%, #4a4540, #3a3530 40%, #2a2520 70%, #1a1510)'
                }
            },
            {
                id: 'haumea',
                name: 'Haumea',
                icon: 'ðŸ¥š',
                unlocked: false,
                cost: 2000000000000,
                multiplier: 100,
                maxPollution: 10000000000000000,
                pollution: 0,
                colors: {
                    clean: 'radial-gradient(circle at 30% 30%, #e8e8e8, #c8c8c8 40%, #a8a8a8 70%, #686868)',
                    mid: 'radial-gradient(circle at 30% 30%, #d8d8d8, #b8b8b8 40%, #989898 70%, #585858)',
                    dirty: 'radial-gradient(circle at 30% 30%, #c8c8c8, #a8a8a8 40%, #888888 70%, #484848)',
                    dead: 'radial-gradient(circle at 30% 30%, #686868, #585858 40%, #484848 70%, #282828)'
                }
            },
            {
                id: 'eris',
                name: 'Eris',
                icon: 'ðŸŒ«ï¸',
                unlocked: false,
                cost: 10000000000000,
                multiplier: 150,
                maxPollution: 50000000000000000,
                pollution: 0,
                colors: {
                    clean: 'radial-gradient(circle at 30% 30%, #d4d4e0, #b4b4c8 40%, #9494b0 70%, #545478)',
                    mid: 'radial-gradient(circle at 30% 30%, #c4c4d0, #a4a4b8 40%, #8484a0 70%, #444468)',
                    dirty: 'radial-gradient(circle at 30% 30%, #b4b4c0, #9494a8 40%, #747490 70%, #343458)',
                    dead: 'radial-gradient(circle at 30% 30%, #5a5a70, #4a4a60 40%, #3a3a50 70%, #2a2a40)'
                }
            },
            {
                id: 'sun',
                name: 'The Sun',
                icon: 'â˜€ï¸',
                unlocked: false,
                cost: 100000000000000,
                multiplier: 500,
                maxPollution: 1000000000000000000,
                pollution: 0,
                colors: {
                    clean: 'radial-gradient(circle at 30% 30%, #ffdd00, #ffaa00 40%, #ff7700 70%, #cc4400)',
                    mid: 'radial-gradient(circle at 30% 30%, #ffcc00, #ff9900 40%, #ff6600 70%, #bb3300)',
                    dirty: 'radial-gradient(circle at 30% 30%, #ffbb00, #ff8800 40%, #ff5500 70%, #aa2200)',
                    dead: 'radial-gradient(circle at 30% 30%, #aa4400, #882200 40%, #661100 70%, #440800)'
                }
            }
        ];

        let currentPlanetIndex = 0;
        let planetsDestroyed = 0;

        // Game State
        let pollution = 0;
        let pollutionPerClick = 1;
        let pollutionPerSecond = 0;
        let totalClicks = 0;
        let totalPollution = 0;

        // Upgrades
        const upgrades = [
            // CLICK UPGRADES
            { id: 'car', name: 'Old Car', icon: 'ðŸš—', desc: '+1 ton per click', baseCost: 15, owned: 0, type: 'click', power: 1 },
            { id: 'suv', name: 'Gas Guzzler SUV', icon: 'ðŸš™', desc: '+3 tons per click', baseCost: 50, owned: 0, type: 'click', power: 3 },
            { id: 'truck', name: 'Diesel Truck', icon: 'ðŸš›', desc: '+8 tons per click', baseCost: 150, owned: 0, type: 'click', power: 8 },
            { id: 'jet', name: 'Private Jet', icon: 'ðŸ›©ï¸', desc: '+20 tons per click', baseCost: 500, owned: 0, type: 'click', power: 20 },
            { id: 'nuke', name: 'Nuclear Plant', icon: 'â˜¢ï¸', desc: '+50 tons per click', baseCost: 1500, owned: 0, type: 'click', power: 50 },
            { id: 'cruise', name: 'Cruise Ship', icon: 'ðŸš¢', desc: '+120 tons per click', baseCost: 5000, owned: 0, type: 'click', power: 120 },
            { id: 'rocket', name: 'Rocket Launch', icon: 'ðŸš€', desc: '+300 tons per click', baseCost: 15000, owned: 0, type: 'click', power: 300 },
            { id: 'chemical', name: 'Chemical Spill', icon: 'ðŸ§ª', desc: '+700 tons per click', baseCost: 40000, owned: 0, type: 'click', power: 700 },
            { id: 'volcano', name: 'Volcano Drill', icon: 'ðŸŒ‹', desc: '+1,500 tons per click', baseCost: 100000, owned: 0, type: 'click', power: 1500 },
            { id: 'nuke_test', name: 'Nuclear Test', icon: 'ðŸ’¥', desc: '+4,000 tons per click', baseCost: 300000, owned: 0, type: 'click', power: 4000 },
            { id: 'asteroid', name: 'Asteroid Mining', icon: 'â˜„ï¸', desc: '+10,000 tons per click', baseCost: 800000, owned: 0, type: 'click', power: 10000 },
            { id: 'antimatter', name: 'Antimatter Engine', icon: 'âš›ï¸', desc: '+25,000 tons per click', baseCost: 2500000, owned: 0, type: 'click', power: 25000 },
            { id: 'blackhole', name: 'Black Hole Generator', icon: 'ðŸ•³ï¸', desc: '+75,000 tons per click', baseCost: 10000000, owned: 0, type: 'click', power: 75000 },
            { id: 'reality', name: 'Reality Corruptor', icon: 'ðŸŒ€', desc: '+200,000 tons per click', baseCost: 50000000, owned: 0, type: 'click', power: 200000 },
            // AUTO UPGRADES
            { id: 'factory', name: 'Coal Factory', icon: 'ðŸ­', desc: 'Emits 2 tons per second', baseCost: 50, owned: 0, type: 'auto', power: 2 },
            { id: 'cattle', name: 'Cattle Ranch', icon: 'ðŸ„', desc: 'Produces 5 tons per second', baseCost: 150, owned: 0, type: 'auto', power: 5 },
            { id: 'plane', name: 'Airplane Fleet', icon: 'âœˆï¸', desc: 'Emits 15 tons per second', baseCost: 400, owned: 0, type: 'auto', power: 15 },
            { id: 'plastic', name: 'Plastic Factory', icon: 'ðŸ§´', desc: 'Dumps 40 tons per second', baseCost: 1000, owned: 0, type: 'auto', power: 40 },
            { id: 'tanker', name: 'Oil Tanker', icon: 'ðŸ›¢ï¸', desc: 'Spills 100 tons per second', baseCost: 3000, owned: 0, type: 'auto', power: 100 },
            { id: 'fracking', name: 'Fracking Operation', icon: 'â›ï¸', desc: 'Leaks 250 tons per second', baseCost: 8000, owned: 0, type: 'auto', power: 250 },
            { id: 'powerplant', name: 'Coal Power Plant', icon: 'âš¡', desc: 'Burns 600 tons per second', baseCost: 20000, owned: 0, type: 'auto', power: 600 },
            { id: 'deforest', name: 'Deforestation Co. HQ', icon: 'ðŸª“', desc: 'Destroys 1,500 tons per second', baseCost: 50000, owned: 0, type: 'auto', power: 1500 },
            { id: 'propaganda', name: 'Propaganda Network', icon: 'ðŸ“º', desc: 'Enables 4,000 tons per second', baseCost: 150000, owned: 0, type: 'auto', power: 4000 },
            { id: 'oilrig', name: 'Offshore Oil Rig', icon: 'ðŸ›¢ï¸', desc: 'Pumps 10,000 tons per second', baseCost: 400000, owned: 0, type: 'auto', power: 10000 },
            { id: 'megacorp', name: 'Mega Corporation', icon: 'ðŸ¢', desc: 'Pollutes 25,000 tons per second', baseCost: 1000000, owned: 0, type: 'auto', power: 25000 },
            { id: 'lobby', name: 'Lobbying Firm', icon: 'ðŸ’¼', desc: 'Blocks 60,000 tons per second', baseCost: 3000000, owned: 0, type: 'auto', power: 60000 },
            { id: 'government', name: 'Corrupt Government', icon: 'ðŸ›ï¸', desc: 'Ignores 150,000 tons per second', baseCost: 8000000, owned: 0, type: 'auto', power: 150000 },
            { id: 'weather', name: 'Weather Machine', icon: 'ðŸŒªï¸', desc: 'Weaponizes 400,000 tons per second', baseCost: 25000000, owned: 0, type: 'auto', power: 400000 },
            { id: 'mindcontrol', name: 'Mind Control Array', icon: 'ðŸ§ ', desc: 'Converts 1M tons per second', baseCost: 80000000, owned: 0, type: 'auto', power: 1000000 },
            { id: 'dystopia', name: 'Dystopian Future', icon: 'ðŸ’€', desc: 'Destroys 3M tons per second', baseCost: 250000000, owned: 0, type: 'auto', power: 3000000 },
            { id: 'singularity', name: 'Pollution Singularity', icon: 'ðŸŒ‘', desc: 'Infinite: 10M tons per second', baseCost: 1000000000, owned: 0, type: 'auto', power: 10000000 }
        ];

        // DOM Elements
        const globeBtn = document.getElementById('globe');
        const smogLayer = document.getElementById('smog');
        const particlesContainer = document.getElementById('particles');
        const pollutionDisplay = document.getElementById('pollution');
        const ppsDisplay = document.getElementById('pps');
        const upgradesContainer = document.getElementById('upgrades');
        const planetShop = document.getElementById('planet-shop');
        const planetTabs = document.getElementById('planet-tabs');
        const clickPowerDisplay = document.getElementById('click-power');
        const totalClicksDisplay = document.getElementById('total-clicks');
        const totalPollutionDisplay = document.getElementById('total-pollution');
        const pollutionFill = document.getElementById('pollution-fill');
        const pollutionPercent = document.getElementById('pollution-percent');
        const scoreText = document.getElementById('score-text');
        const planetNameDisplay = document.getElementById('planet-name');
        const currentPlanetNameDisplay = document.getElementById('current-planet-name');
        const multiplierDisplay = document.getElementById('multiplier-display');
        const planetsDestroyedDisplay = document.getElementById('planets-destroyed');
        const newsText = document.getElementById('news-text');

        function getCurrentPlanet() {
            return planets[currentPlanetIndex];
        }

        function getCost(upgrade) {
            return Math.floor(upgrade.baseCost * Math.pow(1.15, upgrade.owned));
        }

        function formatNumber(num) {
            if (num >= 1e15) return (num / 1e15).toFixed(2) + 'Q';
            if (num >= 1e12) return (num / 1e12).toFixed(2) + 'T';
            if (num >= 1e9) return (num / 1e9).toFixed(2) + 'B';
            if (num >= 1e6) return (num / 1e6).toFixed(2) + 'M';
            if (num >= 1e3) return (num / 1e3).toFixed(2) + 'K';
            return Math.floor(num).toString();
        }

        function updatePlanetAppearance() {
            const planet = getCurrentPlanet();
            const percent = Math.min((planet.pollution / planet.maxPollution) * 100, 100);
            const smogOpacity = Math.min(percent / 100, 0.7);

            smogLayer.style.background = `radial-gradient(circle,
                rgba(139, 90, 43, ${smogOpacity * 0.5}) 0%,
                rgba(80, 60, 30, ${smogOpacity}) 50%,
                rgba(50, 40, 20, ${smogOpacity * 0.8}) 100%)`;

            if (percent > 75) {
                globeBtn.style.background = planet.colors.dead;
            } else if (percent > 50) {
                globeBtn.style.background = planet.colors.dirty;
            } else if (percent > 25) {
                globeBtn.style.background = planet.colors.mid;
            } else {
                globeBtn.style.background = planet.colors.clean;
            }

            pollutionFill.style.width = percent + '%';
            pollutionPercent.textContent = percent.toFixed(2);

            if (percent >= 100 && !planet.destroyed) {
                planet.destroyed = true;
                planetsDestroyed++;
                planetsDestroyedDisplay.textContent = planetsDestroyed;
            }

            if (percent > 50) {
                scoreText.classList.add('polluted');
            } else {
                scoreText.classList.remove('polluted');
            }
        }

        function renderPlanetTabs() {
            planetTabs.innerHTML = '';
            planets.forEach((planet, index) => {
                const tab = document.createElement('div');
                tab.className = 'planet-tab' + (index === currentPlanetIndex ? ' active' : '') + (!planet.unlocked ? ' locked' : '');
                tab.innerHTML = `<span class="planet-emoji">${planet.icon}</span>${planet.name}`;
                if (planet.unlocked) {
                    tab.addEventListener('click', () => switchPlanet(index));
                }
                planetTabs.appendChild(tab);
            });
        }

        function switchPlanet(index) {
            if (!planets[index].unlocked) return;
            currentPlanetIndex = index;
            const planet = getCurrentPlanet();
            planetNameDisplay.textContent = planet.name;
            currentPlanetNameDisplay.textContent = planet.name;
            multiplierDisplay.textContent = `Multiplier: x${planet.multiplier}`;
            renderPlanetTabs();
            updatePlanetAppearance();
            updateDisplay();
        }

        function renderPlanetShop() {
            planetShop.innerHTML = '';
            planets.forEach((planet, index) => {
                if (index === 0) return; // Skip Earth
                const canAfford = pollution >= planet.cost;
                const div = document.createElement('div');
                div.className = 'planet-item' + (!canAfford && !planet.unlocked ? ' disabled' : '') + (planet.unlocked ? ' owned' : '');
                div.setAttribute('data-planet-index', index);
                div.innerHTML = `
                    <div class="planet-header">
                        <span><span class="planet-unlock-icon">${planet.icon}</span><span class="planet-unlock-name">${planet.name}</span></span>
                    </div>
                    <div class="planet-desc">x${planet.multiplier} pollution multiplier</div>
                    <div class="planet-cost">${planet.unlocked ? 'UNLOCKED' : 'Cost: ' + formatNumber(planet.cost) + ' tons'}</div>
                `;
                planetShop.appendChild(div);
            });
        }

        planetShop.addEventListener('click', (e) => {
            const item = e.target.closest('.planet-item');
            if (item && !item.classList.contains('disabled') && !item.classList.contains('owned')) {
                const index = parseInt(item.getAttribute('data-planet-index'));
                if (!isNaN(index) && planets[index] && !planets[index].unlocked) {
                    buyPlanet(index);
                }
            }
        });

        function buyPlanet(index) {
            const planet = planets[index];
            if (pollution >= planet.cost && !planet.unlocked) {
                pollution -= planet.cost;
                planet.unlocked = true;
                renderPlanetTabs();
                renderPlanetShop();
                updateDisplay();
                saveGame();
            }
        }

        function createParticle(x, y, amount) {
            const particle = document.createElement('div');
            particle.className = 'click-particle';
            particle.textContent = '+' + formatNumber(amount);
            particle.style.left = x + 'px';
            particle.style.top = y + 'px';
            document.body.appendChild(particle);
            setTimeout(() => particle.remove(), 1000);
        }

        function createSmoke() {
            const smoke = document.createElement('div');
            smoke.className = 'smoke-particle';
            smoke.style.left = (Math.random() * 200 + 40) + 'px';
            smoke.style.top = (Math.random() * 100 + 100) + 'px';
            particlesContainer.appendChild(smoke);
            setTimeout(() => smoke.remove(), 2000);
        }

        function updateDisplay() {
            const planet = getCurrentPlanet();
            pollutionDisplay.textContent = formatNumber(pollution);
            ppsDisplay.textContent = formatNumber(pollutionPerSecond * planet.multiplier);
            clickPowerDisplay.textContent = formatNumber(pollutionPerClick * planet.multiplier);
            totalClicksDisplay.textContent = formatNumber(totalClicks);
            totalPollutionDisplay.textContent = formatNumber(totalPollution);
            updatePlanetAppearance();
            updateUpgradeStates();
            updatePlanetShopStates();
        }

        function updateUpgradeStates() {
            const items = upgradesContainer.querySelectorAll('.upgrade-item');
            items.forEach((item, index) => {
                if (upgrades[index]) {
                    const cost = getCost(upgrades[index]);
                    const canAfford = pollution >= cost;
                    item.classList.toggle('disabled', !canAfford);
                }
            });
        }

        function updatePlanetShopStates() {
            const items = planetShop.querySelectorAll('.planet-item');
            items.forEach((item) => {
                const index = parseInt(item.getAttribute('data-planet-index'));
                if (!isNaN(index) && planets[index] && !planets[index].unlocked) {
                    const canAfford = pollution >= planets[index].cost;
                    item.classList.toggle('disabled', !canAfford);
                }
            });
        }

        function renderUpgrades() {
            upgradesContainer.innerHTML = '';
            upgrades.forEach((upgrade, index) => {
                const cost = getCost(upgrade);
                const canAfford = pollution >= cost;
                const div = document.createElement('div');
                div.className = 'upgrade-item' + (canAfford ? '' : ' disabled');
                div.setAttribute('data-index', index);
                div.innerHTML = `
                    <div class="upgrade-header">
                        <span><span class="upgrade-icon">${upgrade.icon}</span><span class="upgrade-name">${upgrade.name}</span></span>
                        <span class="upgrade-count">${upgrade.owned}</span>
                    </div>
                    <div class="upgrade-desc">${upgrade.desc}</div>
                    <div class="upgrade-cost">Cost: ${formatNumber(cost)} tons</div>
                `;
                upgradesContainer.appendChild(div);
            });
        }

        upgradesContainer.addEventListener('click', (e) => {
            const item = e.target.closest('.upgrade-item');
            if (item && !item.classList.contains('disabled')) {
                const index = parseInt(item.getAttribute('data-index'));
                if (!isNaN(index) && upgrades[index]) {
                    buyUpgrade(upgrades[index]);
                }
            }
        });

        function buyUpgrade(upgrade) {
            const cost = getCost(upgrade);
            if (pollution >= cost) {
                const wasFirstPurchase = upgrade.owned === 0;
                pollution -= cost;
                upgrade.owned++;
                if (upgrade.type === 'click') {
                    pollutionPerClick += upgrade.power;
                } else if (upgrade.type === 'auto') {
                    pollutionPerSecond += upgrade.power;
                }
                // Show news on first purchase
                if (wasFirstPurchase && storyMessages.upgrades[upgrade.id]) {
                    newsText.innerHTML = storyMessages.upgrades[upgrade.id];
                }
                renderUpgrades();
                updateDisplay();
                saveGame();
            }
        }

        globeBtn.addEventListener('click', (e) => {
            const planet = getCurrentPlanet();
            const amount = pollutionPerClick * planet.multiplier;
            pollution += amount;
            planet.pollution += amount;
            totalClicks++;
            totalPollution += amount;

            const rect = globeBtn.getBoundingClientRect();
            const x = e.clientX || (rect.left + rect.width / 2);
            const y = e.clientY || (rect.top + rect.height / 2);
            createParticle(x - 20, y - 20, amount);

            for (let i = 0; i < 3; i++) {
                setTimeout(() => createSmoke(), i * 100);
            }

            updateDisplay();
        });

        setInterval(() => {
            if (pollutionPerSecond > 0) {
                const planet = getCurrentPlanet();
                const amount = (pollutionPerSecond * planet.multiplier) / 10;
                pollution += amount;
                planet.pollution += amount;
                totalPollution += amount;
                updateDisplay();

                if (Math.random() < 0.3) {
                    createSmoke();
                }
            }
        }, 100);

        function saveGame() {
            const saveData = {
                pollution,
                pollutionPerClick,
                pollutionPerSecond,
                totalClicks,
                totalPollution,
                currentPlanetIndex,
                planetsDestroyed,
                upgrades: upgrades.map(u => ({ id: u.id, owned: u.owned })),
                planets: planets.map(p => ({ id: p.id, unlocked: p.unlocked, pollution: p.pollution, destroyed: p.destroyed }))
            };
            localStorage.setItem('pollutionClickerSave', JSON.stringify(saveData));
        }

        function loadGame() {
            const saved = localStorage.getItem('pollutionClickerSave');
            if (saved) {
                const data = JSON.parse(saved);
                pollution = data.pollution || 0;
                pollutionPerClick = data.pollutionPerClick || 1;
                pollutionPerSecond = data.pollutionPerSecond || 0;
                totalClicks = data.totalClicks || 0;
                totalPollution = data.totalPollution || 0;
                currentPlanetIndex = data.currentPlanetIndex || 0;
                planetsDestroyed = data.planetsDestroyed || 0;

                if (data.upgrades) {
                    data.upgrades.forEach(savedUpgrade => {
                        const upgrade = upgrades.find(u => u.id === savedUpgrade.id);
                        if (upgrade) upgrade.owned = savedUpgrade.owned;
                    });
                }

                if (data.planets) {
                    data.planets.forEach(savedPlanet => {
                        const planet = planets.find(p => p.id === savedPlanet.id);
                        if (planet) {
                            planet.unlocked = savedPlanet.unlocked;
                            planet.pollution = savedPlanet.pollution || 0;
                            planet.destroyed = savedPlanet.destroyed || false;
                        }
                    });
                }
            }
        }

        setInterval(saveGame, 30000);

        // Story System
        let lastStoryIndex = -1;
        let storyPhase = 0;

        const storyMessages = {
            // Early game - innocent beginnings
            early: [
                "Welcome to Earth. The air is still breathable... for now.",
                "Scientists warn about rising CO2 levels. Nobody listens.",
                "A small company called <span>Deforestation Co.</span> files for a business license.",
                "Local factory opens. Promises 'minimal environmental impact.'",
                "News: Person clicks globe for fun. Experts concerned.",
                "<span>Deforestation Co.</span> CEO: 'Trees are overrated anyway.'",
                "Climate protesters gather. <span>Deforestation Co.</span> offers them jobs.",
                "Study finds pollution 'not that bad.' Study funded by coal industry.",
            ],
            // Getting worse
            rising: [
                "<span>Deforestation Co.</span> acquires three competing lumber companies.",
                "Breaking: Amazon rainforest now 'Amazon parking lot.'",
                "<span>Deforestation Co.</span> lobbying firm wins 'Most Effective' award.",
                "Oil spill declared 'free seasoning for fish' by industry spokesman.",
                "Penguins seen wearing tiny gas masks. Scientists baffled.",
                "<span>Deforestation Co.</span> sponsors local little league. Team renamed 'The Smog.'",
                "New study: Trees 'had it coming.' Source: <span>Deforestation Co.</span>",
                "Coal factory wins 'Greenest Building' award. Judges were blindfolded.",
                "Birds flying south. And east. And west. Anywhere but here.",
            ],
            // Mid game - corporate takeover
            corporate: [
                "<span>Deforestation Co.</span> named 'Company of the Year' by Pollution Weekly.",
                "Breaking: <span>Deforestation Co.</span> purchases entire government. 'Good investment,' says CEO.",
                "New law: Breathing clean air now requires premium subscription.",
                "<span>Deforestation Co.</span> rebrands: 'We're not killing the planet, we're giving it character.'",
                "Last polar bear seen applying for refugee status.",
                "Oceans now 40% plastic. <span>Deforestation Co.</span>: 'Free building materials!'",
                "Sun appears red. <span>Deforestation Co.</span> claims credit for 'aesthetic improvement.'",
                "Scientists who criticized pollution missing. Unrelated, says <span>Deforestation Co.</span>",
                "New <span>Deforestation Co.</span> slogan: 'Earth was boring green anyway.'",
            ],
            // Late game - dystopia
            dystopia: [
                "<span>Deforestation Co.</span> announces plans to pollute other planets. 'Earth was just practice.'",
                "Breaking: Breathable air now sold in bottles. <span>Deforestation Co.</span> brand.",
                "Last tree on Earth purchased by <span>Deforestation Co.</span> CEO. Used as toothpick.",
                "Mars colony established. First building: <span>Deforestation Co.</span> factory.",
                "Children ask: 'What was grass?' Parents don't remember either.",
                "<span>Deforestation Co.</span> achieves monopoly on all life-sustaining resources.",
                "Earth's atmosphere now 'crunchy.' Scientists can't explain.",
                "The sun looks different today. <span>Deforestation Co.</span> targeting it next.",
                "<span>Deforestation Co.</span> IPO breaks all records. Stock price: your soul.",
            ],
            // End game - cosmic horror
            cosmic: [
                "<span>Deforestation Co.</span> successfully pollutes the sun. 'Our greatest achievement.'",
                "The void between stars fills with smog. <span>Deforestation Co.</span> expands infinitely.",
                "Aliens make contact. Immediately regret it. Leave quickly.",
                "Time itself now sponsored by <span>Deforestation Co.</span>",
                "The universe asks <span>Deforestation Co.</span> to stop. Request denied.",
                "Reality begins to smell like diesel. This is normal now.",
                "God calls. <span>Deforestation Co.</span> puts Him on hold.",
                "Heat death of universe accelerated. <span>Deforestation Co.</span> calls it 'efficiency.'",
                "There is only <span>Deforestation Co.</span> There was only ever <span>Deforestation Co.</span>",
            ],
            // Planet-specific
            planets: {
                mercury: "Mercury acquired. <span>Deforestation Co.</span>: 'Already hot, perfect for industry.'",
                venus: "Venus colonized. 'Finally, a planet that matches our vision,' says CEO.",
                mars: "Mars terraforming complete. It's now brown instead of red.",
                ceres: "Ceres strip-mined. <span>Deforestation Co.</span> finds it 'cute.'",
                jupiter: "Jupiter's Great Red Spot now Great Brown Spot. 'Improvement,' claims company.",
                saturn: "Saturn's rings replaced with smog rings. 'More mysterious,' says PR team.",
                neptune: "Neptune reached. Even here, <span>Deforestation Co.</span> finds something to ruin.",
                pluto: "Pluto polluted. 'Not even a real planet and we got it anyway.'",
                haumea: "Haumea conquered. Its weird shape now weirder.",
                eris: "Eris falls to <span>Deforestation Co.</span> Discord goddess approves.",
                sun: "THE SUN HAS BEEN POLLUTED. <span>DEFORESTATION CO.</span> WINS. EXISTENCE LOSES.",
            },
            // Random flavor
            random: [
                "Intern accidentally creates new greenhouse gas. Gets promoted.",
                "Fish evolve lungs. Immediately regret decision.",
                "Cloud seeding replaced with smog seeding. 'Same thing,' says expert.",
                "Volcano erupts. <span>Deforestation Co.</span> sues for copyright infringement.",
                "Rainbow now has 50 shades of gray.",
                "Wind turbines repurposed as giant fans to spread pollution faster.",
                "Electric cars banned. 'Too clean,' rules <span>Deforestation Co.</span> court.",
                "Ocean cleanup cancelled. 'The plastic stays,' announces CEO.",
                "Recycling outlawed. '<span>Deforestation Co.</span> needs job security.'",
                "Nature documentary becomes horror film. No CGI needed.",
            ],
            // Upgrade-specific stories (triggered on first purchase)
            upgrades: {
                car: "Your first polluting vehicle! <span>Deforestation Co.</span> sends a welcome basket.",
                suv: "SUV acquired. 8 miles per gallon. <span>Deforestation Co.</span> approves.",
                truck: "Diesel truck rolling coal down Main Street. Pedestrians coughing.",
                jet: "BREAKING: Local person buys private jet. Carbon footprint now visible from space.",
                nuke: "Nuclear plant online. 'Totally safe,' says guy in hazmat suit.",
                cruise: "Cruise ship launched! Each passenger produces 3x more CO2 than at home.",
                rocket: "Rocket program initiated. The sky is no longer the limit for pollution.",
                chemical: "ALERT: Chemical spill reported. <span>Deforestation Co.</span>: 'It's a feature.'",
                volcano: "Scientists baffled as someone drills into active volcano 'for fun.'",
                nuke_test: "FLASH: Nuclear test conducted. Birds now glow. 'Convenient,' says hunter.",
                asteroid: "Space mining begins! <span>Deforestation Co.</span> expands beyond Earth.",
                antimatter: "Antimatter engine created. Physics textbooks being rewritten with more pollution.",
                blackhole: "BLACK HOLE GENERATOR ONLINE. Scientists: 'This seems bad.' <span>Deforestation Co.</span>: 'Seems profitable.'",
                reality: "REALITY ITSELF NOW POLLUTED. <span>Deforestation Co.</span> transcends physical law.",
                factory: "First factory built! The Industrial Revolution 2.0 begins.",
                cattle: "Cattle ranch established. Methane production: maximum. Cows: confused.",
                plane: "Airplane fleet takes off! Chemtrails now actual chemicals.",
                plastic: "Plastic factory opens. Ocean wildlife sends formal complaint. Complaint ignored.",
                tanker: "Oil tanker fleet deployed. Seagulls now permanently greased.",
                fracking: "FRACKING BEGINS. Tap water now flammable. <span>Deforestation Co.</span>: 'Free heating!'",
                powerplant: "Coal power plant operational. Local mountains now 'mountain-shaped holes.'",
                deforest: "<span>DEFORESTATION CO. HEADQUARTERS ESTABLISHED!</span> The real game begins now.",
                propaganda: "Propaganda network launched! 'Pollution is good for you' now trending.",
                oilrig: "Offshore oil rig constructed. Fish formally request relocation assistance.",
                megacorp: "<span>Deforestation Co.</span> achieves Mega Corporation status. Resistance is futile.",
                lobby: "Lobbying firm hired. Environmental laws now 'suggestions.'",
                government: "GOVERNMENT ACQUIRED. <span>Deforestation Co.</span> CEO now makes the laws.",
                weather: "Weather machine activated! Sunny days are now 'legacy features.'",
                mindcontrol: "MIND CONTROL ARRAY ONLINE. Everyone loves pollution now. Compliance is happiness.",
                dystopia: "DYSTOPIAN FUTURE ACHIEVED. <span>Deforestation Co.</span>'s vision is complete.",
                singularity: "POLLUTION SINGULARITY REACHED. All matter is now pollution. Pollution is all."
            }
        };

        function getStoryPhase() {
            if (totalPollution >= 1e17) return 'cosmic';
            if (totalPollution >= 1e14) return 'dystopia';
            if (totalPollution >= 1e11) return 'corporate';
            if (totalPollution >= 1e8) return 'rising';
            return 'early';
        }

        function getRandomNews() {
            const phase = getStoryPhase();
            const messages = storyMessages[phase];

            // 20% chance for random flavor text
            if (Math.random() < 0.2) {
                const randomMsgs = storyMessages.random;
                return randomMsgs[Math.floor(Math.random() * randomMsgs.length)];
            }

            // Check for planet-specific messages
            for (const planet of planets) {
                if (planet.unlocked && !planet.newsShown && planet.id !== 'earth') {
                    planet.newsShown = true;
                    if (storyMessages.planets[planet.id]) {
                        return storyMessages.planets[planet.id];
                    }
                }
            }

            let index;
            do {
                index = Math.floor(Math.random() * messages.length);
            } while (index === lastStoryIndex && messages.length > 1);

            lastStoryIndex = index;
            return messages[index];
        }

        function updateNews() {
            newsText.innerHTML = getRandomNews();
        }

        // Update news every 15 seconds
        setInterval(updateNews, 15000);

        // Initialize
        loadGame();
        const planet = getCurrentPlanet();
        planetNameDisplay.textContent = planet.name;
        currentPlanetNameDisplay.textContent = planet.name;
        multiplierDisplay.textContent = `Multiplier: x${planet.multiplier}`;
        planetsDestroyedDisplay.textContent = planetsDestroyed;
        renderPlanetTabs();
        renderUpgrades();
        renderPlanetShop();
        updateDisplay();
    </script>
</body>
</html>
